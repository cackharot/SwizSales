2012-09-08 13:12:13,749 [9] ERROR SwizSalesLog - Error while searching customer
System.NotSupportedException: The method 'Skip' is only supported for sorted input in LINQ to Entities. The method 'OrderBy' must be called before the method 'Skip'.
   at System.Data.Objects.ELinq.ExpressionConverter.OrderByLifter.PassthroughOrderByLifter.Skip(DbExpression k)
   at System.Data.Objects.ELinq.ExpressionConverter.Skip(DbExpressionBinding input, DbExpression skipCount)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SkipTranslator.TranslatePagingOperator(ExpressionConverter parent, DbExpression operand, DbExpression count)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.PagingTranslator.TranslateUnary(ExpressionConverter parent, DbExpression operand, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.UnarySequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, SequenceMethod sequenceMethod)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.UnarySequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, SequenceMethod sequenceMethod)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.Convert()
   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at SwizSales.Core.Services.CustomerService.Search(CustomerSearchCondition condition) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 39
2012-09-08 14:09:25,287 [9] ERROR SwizSalesLog - Error while searching customer
System.Data.EntityCommandCompilationException: An error occurred while preparing the command definition. See the inner exception for details. ---> System.Data.MappingException: 
Model.SwizModel.msl(16,10) : error 3015: Problem in mapping fragments starting at lines 16, 207:Foreign key constraint 'FK_SupplierContactDetail' from table Suppliers (ContactDetailId) to table ContactDetails (Id):: Insufficient mapping: Foreign key must be mapped to some AssociationSet or EntitySets participating in a foreign key association on the conceptual side.

   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGenerateViews(EntityContainer container, Dictionary`2 resultDictionary)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGetGeneratedViews(EntityContainer container)
   at System.Data.Common.Utils.Memoizer`2.<>c__DisplayClass2.<Evaluate>b__0()
   at System.Data.Common.Utils.Memoizer`2.Result.GetValue()
   at System.Data.Common.Utils.Memoizer`2.Evaluate(TArg arg)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.GetGeneratedView(EntitySetBase extent, MetadataWorkspace workspace, StorageMappingItemCollection storageMappingItemCollection)
   at System.Data.Metadata.Edm.MetadataWorkspace.GetGeneratedView(EntitySetBase extent)
   at System.Data.Query.PlanCompiler.PreProcessor.ExpandView(Node node, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.ProcessScanTable(Node scanTableNode, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ScanTableOp op, Node n)
   at System.Data.Query.InternalTrees.ScanTableOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(FilterOp op, Node n)
   at System.Data.Query.InternalTrees.FilterOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitSortOp(SortBaseOp op, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.Visit(ConstrainedSortOp op, Node n)
   at System.Data.Query.InternalTrees.ConstrainedSortOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitDefault(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitPhysicalOpDefault(PhysicalOp op, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.Visit(PhysicalProjectOp op, Node n)
   at System.Data.Query.InternalTrees.PhysicalProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Process()
   at System.Data.Query.PlanCompiler.PreProcessor.Process(PlanCompiler planCompilerState, StructuredTypeInfo& typeInfo)
   at System.Data.Query.PlanCompiler.PlanCompiler.Compile(List`1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets)
   at System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree)
   --- End of inner exception stack trace ---
   at System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree)
   at System.Data.EntityClient.EntityProviderServices.CreateCommandDefinition(DbProviderFactory storeProviderFactory, DbCommandTree commandTree)
   at System.Data.EntityClient.EntityProviderServices.CreateDbCommandDefinition(DbProviderManifest providerManifest, DbCommandTree commandTree)
   at System.Data.Common.DbProviderServices.CreateCommandDefinition(DbCommandTree commandTree)
   at System.Data.Objects.Internal.ObjectQueryExecutionPlan.Prepare(ObjectContext context, DbQueryCommandTree tree, Type elementType, MergeOption mergeOption, Span span, ReadOnlyCollection`1 compiledQueryParameters)
   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at SwizSales.Core.Services.CustomerService.Search(CustomerSearchCondition condition) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 45
2012-09-08 21:21:22,357 [10] ERROR SwizSalesLog - Error while adding customer
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Cannot insert the value NULL into column 'CreatedBy', table 'OpenPOSDb.dbo.Customers'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.CustomerService.Add(Customer entity) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 116
2012-09-08 21:35:10,995 [9] ERROR SwizSalesLog - Error while adding customer
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Violation of PRIMARY KEY constraint 'PK_ContactDetails'. Cannot insert duplicate key in object 'dbo.ContactDetails'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.CustomerService.Add(Customer entity) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 115
2012-09-08 21:36:14,065 [9] ERROR SwizSalesLog - Error while adding customer
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Violation of PRIMARY KEY constraint 'PK_ContactDetails'. Cannot insert duplicate key in object 'dbo.ContactDetails'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.CustomerService.Add(Customer entity) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 115
2012-09-08 22:07:03,640 [9] ERROR SwizSalesLog - Error while fetching customer
System.NotSupportedException: LINQ to Entities does not recognize the method 'System.String ToString()' method, and this method cannot be translated into a store expression.
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.DefaultTranslator.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.EqualsTranslator.TypedTranslate(ExpressionConverter parent, BinaryExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateLambda(LambdaExpression lambda, DbExpression input)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateLambda(LambdaExpression lambda, DbExpression input, DbExpressionBinding& binding)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.OneLambdaTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, DbExpression& source, DbExpressionBinding& sourceBinding, DbExpression& lambda)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.FirstPredicateTranslatorBase.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SinglePredicateTranslatorBase.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, SequenceMethod sequenceMethod)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.Convert()
   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__2[TResult](IEnumerable`1 sequence)
   at System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle[TResult](IEnumerable`1 query, Expression queryRoot)
   at System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at SwizSales.Core.Services.CustomerService.GetCustomerById(String Id) in C:\Users\cackharot\Documents\Visual Studio 2010\Projects\SwizSales\SwizSales.Core\Services\CustomerService.cs:line 77
2012-09-23 11:49:56,014 [9] ERROR SwizSalesLog - Print error
System.NotSupportedException: DocumentViewer supports only FixedDocument or FixedDocumentSequence documents.
   at System.Windows.Controls.DocumentViewer.OnDocumentChanged()
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(IDocumentPaginatorSource oldDocument, IDocumentPaginatorSource newDocument)
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.ScheduleTransfer(Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.NewValueAvailable(Boolean dependencySourcesChanged, Boolean initialValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.PropertyPathWorker.UpdateSourceValueState(Int32 k, ICollectionView collectionView, Object newValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.OnSourcePropertyChanged(Object o, String propName)
   at MS.Internal.Data.PropertyPathWorker.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.ComponentModel.PropertyChangedEventManager.OnPropertyChanged(Object sender, PropertyChangedEventArgs args)
   at SimpleMvvmToolkit.BindingHelper.InternalNotifyPropertyChanged(String propertyName, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 62
   at SimpleMvvmToolkit.BindingHelper.NotifyPropertyChanged[TModel,TResult](Expression`1 property, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 24
   at SimpleMvvmToolkit.ViewModelBase`1.NotifyPropertyChanged[TResult](Expression`1 property) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\ViewModelBase.cs:line 40
   at SwizSales.ViewModel.TicketPrinterViewModel.set_FlowDocument(FlowDocument value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 56
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 104
2012-09-23 11:50:37,690 [9] ERROR SwizSalesLog - Print error
System.NotSupportedException: DocumentViewer supports only FixedDocument or FixedDocumentSequence documents.
   at System.Windows.Controls.DocumentViewer.OnDocumentChanged()
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(IDocumentPaginatorSource oldDocument, IDocumentPaginatorSource newDocument)
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.ScheduleTransfer(Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.NewValueAvailable(Boolean dependencySourcesChanged, Boolean initialValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.PropertyPathWorker.UpdateSourceValueState(Int32 k, ICollectionView collectionView, Object newValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.OnSourcePropertyChanged(Object o, String propName)
   at MS.Internal.Data.PropertyPathWorker.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.ComponentModel.PropertyChangedEventManager.OnPropertyChanged(Object sender, PropertyChangedEventArgs args)
   at SimpleMvvmToolkit.BindingHelper.InternalNotifyPropertyChanged(String propertyName, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 62
   at SimpleMvvmToolkit.BindingHelper.NotifyPropertyChanged[TModel,TResult](Expression`1 property, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 24
   at SimpleMvvmToolkit.ViewModelBase`1.NotifyPropertyChanged[TResult](Expression`1 property) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\ViewModelBase.cs:line 40
   at SwizSales.ViewModel.TicketPrinterViewModel.set_FlowDocument(FlowDocument value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 56
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 104
2012-09-23 11:50:45,245 [9] ERROR SwizSalesLog - Print error
System.NotSupportedException: DocumentViewer supports only FixedDocument or FixedDocumentSequence documents.
   at System.Windows.Controls.DocumentViewer.OnDocumentChanged()
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(IDocumentPaginatorSource oldDocument, IDocumentPaginatorSource newDocument)
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.ScheduleTransfer(Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.NewValueAvailable(Boolean dependencySourcesChanged, Boolean initialValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.PropertyPathWorker.UpdateSourceValueState(Int32 k, ICollectionView collectionView, Object newValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.OnSourcePropertyChanged(Object o, String propName)
   at MS.Internal.Data.PropertyPathWorker.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.ComponentModel.PropertyChangedEventManager.OnPropertyChanged(Object sender, PropertyChangedEventArgs args)
   at SimpleMvvmToolkit.BindingHelper.InternalNotifyPropertyChanged(String propertyName, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 62
   at SimpleMvvmToolkit.BindingHelper.NotifyPropertyChanged[TModel,TResult](Expression`1 property, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 24
   at SimpleMvvmToolkit.ViewModelBase`1.NotifyPropertyChanged[TResult](Expression`1 property) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\ViewModelBase.cs:line 40
   at SwizSales.ViewModel.TicketPrinterViewModel.set_FlowDocument(FlowDocument value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 56
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 104
2012-09-23 11:51:22,082 [9] ERROR SwizSalesLog - Print error
System.NotSupportedException: DocumentViewer supports only FixedDocument or FixedDocumentSequence documents.
   at System.Windows.Controls.DocumentViewer.OnDocumentChanged()
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(IDocumentPaginatorSource oldDocument, IDocumentPaginatorSource newDocument)
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.ScheduleTransfer(Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.NewValueAvailable(Boolean dependencySourcesChanged, Boolean initialValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.PropertyPathWorker.UpdateSourceValueState(Int32 k, ICollectionView collectionView, Object newValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.OnSourcePropertyChanged(Object o, String propName)
   at MS.Internal.Data.PropertyPathWorker.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.ComponentModel.PropertyChangedEventManager.OnPropertyChanged(Object sender, PropertyChangedEventArgs args)
   at SimpleMvvmToolkit.BindingHelper.InternalNotifyPropertyChanged(String propertyName, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 62
   at SimpleMvvmToolkit.BindingHelper.NotifyPropertyChanged[TModel,TResult](Expression`1 property, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 24
   at SimpleMvvmToolkit.ViewModelBase`1.NotifyPropertyChanged[TResult](Expression`1 property) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\ViewModelBase.cs:line 40
   at SwizSales.ViewModel.TicketPrinterViewModel.set_FlowDocument(FlowDocument value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 56
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 104
2012-09-23 13:23:57,754 [10] ERROR SwizSalesLog - Print error
System.NotSupportedException: DocumentViewer supports only FixedDocument or FixedDocumentSequence documents.
   at System.Windows.Controls.DocumentViewer.OnDocumentChanged()
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(IDocumentPaginatorSource oldDocument, IDocumentPaginatorSource newDocument)
   at System.Windows.Controls.Primitives.DocumentViewerBase.DocumentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.ScheduleTransfer(Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.NewValueAvailable(Boolean dependencySourcesChanged, Boolean initialValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.PropertyPathWorker.UpdateSourceValueState(Int32 k, ICollectionView collectionView, Object newValue, Boolean isASubPropertyChange)
   at MS.Internal.Data.ClrBindingWorker.OnSourcePropertyChanged(Object o, String propName)
   at MS.Internal.Data.PropertyPathWorker.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.ComponentModel.PropertyChangedEventManager.OnPropertyChanged(Object sender, PropertyChangedEventArgs args)
   at SimpleMvvmToolkit.BindingHelper.InternalNotifyPropertyChanged(String propertyName, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 62
   at SimpleMvvmToolkit.BindingHelper.NotifyPropertyChanged[TModel,TResult](Expression`1 property, Object sender, PropertyChangedEventHandler propertyChanged, Dispatcher dispatcher) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\BindingHelper.cs:line 24
   at SimpleMvvmToolkit.ViewModelBase`1.NotifyPropertyChanged[TResult](Expression`1 property) in C:\Projects\SimpleMvvmToolkit\Download\SimpleMvvmToolkit\Source\Silverlight\v5.0\SimpleMvvmToolkit-v5.0\ViewModelBase.cs:line 40
   at SwizSales.ViewModel.TicketPrinterViewModel.set_Document(FlowDocument value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 56
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 115
2012-09-23 13:56:12,662 [9] ERROR SwizSalesLog - Print error
System.ObjectDisposedException: Package object was closed and disposed, so cannot carry out operations on this object or any stream opened on a part of this package.
   at System.IO.Packaging.Package.ThrowIfObjectDisposed()
   at System.IO.Packaging.Package.get_FileOpenAccess()
   at System.Windows.Xps.Packaging.XpsManager.get_IsReader()
   at System.Windows.Xps.Packaging.XpsDocument.get_IsReader()
   at System.Windows.Xps.Packaging.XpsDocument.GetFixedDocumentSequence()
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 116
2012-09-23 14:01:05,985 [9] ERROR SwizSalesLog - Print error
System.ArgumentException: Cannot perform a read/write operation in write-only or read-only modes.
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.CheckFileAccessParameter(Stream stream, FileAccess access)
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.ZipPackagePart.GetStreamCore(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream()
   at System.Windows.Xps.Packaging.XpsDocument.GetFixedDocumentSequence()
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 116
2012-09-23 14:01:11,182 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: A package with the same URI is already in the package store.
   at System.IO.Packaging.PackageStore.AddPackage(Uri uri, Package package)
   at SwizSales.PrintHelper.GetXpsDocument(FlowDocument document) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 110
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 115
2012-09-23 14:02:51,272 [9] ERROR SwizSalesLog - Print error
System.ArgumentException: Cannot perform a read/write operation in write-only or read-only modes.
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.CheckFileAccessParameter(Stream stream, FileAccess access)
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.ZipPackagePart.GetStreamCore(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream()
   at System.Windows.Xps.Packaging.XpsDocument.GetFixedDocumentSequence()
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 116
2012-09-23 14:07:16,454 [9] ERROR SwizSalesLog - Print error
System.ArgumentException: Cannot perform a read/write operation in write-only or read-only modes.
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.CheckFileAccessParameter(Stream stream, FileAccess access)
   at MS.Internal.IO.Zip.ZipIOLocalFileBlock.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.ZipPackagePart.GetStreamCore(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream(FileMode mode, FileAccess access)
   at System.IO.Packaging.PackagePart.GetStream()
   at System.Windows.Xps.Packaging.XpsDocument.GetFixedDocumentSequence()
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 116
2012-09-23 15:26:17,554 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 119
2012-09-28 10:32:22,008 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 122
2012-09-28 10:34:05,515 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 122
2012-09-28 10:59:39,619 [9] ERROR SwizSalesLog - Error while adding order
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Violation of PRIMARY KEY constraint 'PK_Customers'. Cannot insert duplicate key in object 'dbo.Customers'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 168
2012-09-28 10:59:39,879 [9] ERROR SwizSalesLog - Error while creating new order
System.ArgumentException: Error while adding new order! ---> System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Violation of PRIMARY KEY constraint 'PK_Customers'. Cannot insert duplicate key in object 'dbo.Customers'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 168
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 174
   at SwizSales.Core.Services.OrderService.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 144
   at SwizSales.ViewModel.SalesViewModel.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 335
2012-09-28 11:02:31,024 [9] ERROR SwizSalesLog - Error while adding order
System.InvalidOperationException: The object could not be added or attached because its EntityReference has an EntityKey property value that does not match the EntityKey for this object.
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 169
2012-09-28 11:19:50,673 [9] ERROR SwizSalesLog - Error while creating new order
System.InvalidOperationException: The relationship between the two objects cannot be defined because they are attached to different ObjectContext objects.
   at System.Data.Objects.DataClasses.RelatedEnd.Add(IEntityWrapper wrappedTarget, Boolean applyConstraints, Boolean addRelationshipAsUnchanged, Boolean relationshipAlreadyExists, Boolean allowModifyingOtherEndOfRelationship, Boolean forceForeignKeyChanges)
   at System.Data.Objects.DataClasses.RelatedEnd.Add(IEntityWrapper wrappedEntity, Boolean applyConstraints)
   at System.Data.Objects.DataClasses.EntityReference`1.set_ReferenceValue(IEntityWrapper value)
   at System.Data.Objects.DataClasses.EntityReference`1.set_Value(TEntity value)
   at SwizSales.Core.Model.Order.set_Customer(Customer value) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Model\SwizModel.Designer.cs:line 1935
   at SwizSales.Core.Services.OrderService.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 150
   at SwizSales.ViewModel.SalesViewModel.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 335
2012-09-28 11:25:25,142 [10] ERROR SwizSalesLog - Error while adding order
System.InvalidOperationException: The object could not be added or attached because its EntityReference has an EntityKey property value that does not match the EntityKey for this object.
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 177
2012-09-28 11:26:41,937 [10] ERROR SwizSalesLog - Error while adding order
System.InvalidOperationException: The object could not be added or attached because its EntityReference has an EntityKey property value that does not match the EntityKey for this object.
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 177
2012-09-28 11:26:41,979 [10] ERROR SwizSalesLog - Error while creating new order
System.ArgumentException: Error while adding new order! ---> System.InvalidOperationException: The object could not be added or attached because its EntityReference has an EntityKey property value that does not match the EntityKey for this object.
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 177
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Add(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 184
   at SwizSales.Core.Services.OrderService.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 151
   at SwizSales.ViewModel.SalesViewModel.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 335
2012-09-28 11:31:46,573 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 220
2012-09-28 11:31:46,639 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 220
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 229
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-09-28 11:35:16,995 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at System.Data.Objects.Internal.LightweightEntityWrapper`1.set_EntityKey(EntityKey value)
   at System.Data.Objects.ObjectStateManager.AddEntry(IEntityWrapper wrappedObject, EntityKey passedKey, EntitySet entitySet, String argumentName, Boolean isAdded)
   at System.Data.Objects.ObjectContext.AddSingleObject(EntitySet entitySet, IEntityWrapper wrappedEntity, String argumentName)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 230
2012-09-28 11:35:17,081 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at System.Data.Objects.Internal.LightweightEntityWrapper`1.set_EntityKey(EntityKey value)
   at System.Data.Objects.ObjectStateManager.AddEntry(IEntityWrapper wrappedObject, EntityKey passedKey, EntitySet entitySet, String argumentName, Boolean isAdded)
   at System.Data.Objects.ObjectContext.AddSingleObject(EntitySet entitySet, IEntityWrapper wrappedEntity, String argumentName)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 230
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 239
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-09-28 11:35:51,218 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at System.Data.Objects.Internal.LightweightEntityWrapper`1.set_EntityKey(EntityKey value)
   at System.Data.Objects.ObjectStateManager.AddEntry(IEntityWrapper wrappedObject, EntityKey passedKey, EntitySet entitySet, String argumentName, Boolean isAdded)
   at System.Data.Objects.ObjectContext.AddSingleObject(EntitySet entitySet, IEntityWrapper wrappedEntity, String argumentName)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 230
2012-09-28 11:35:51,250 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at System.Data.Objects.Internal.LightweightEntityWrapper`1.set_EntityKey(EntityKey value)
   at System.Data.Objects.ObjectStateManager.AddEntry(IEntityWrapper wrappedObject, EntityKey passedKey, EntitySet entitySet, String argumentName, Boolean isAdded)
   at System.Data.Objects.ObjectContext.AddSingleObject(EntitySet entitySet, IEntityWrapper wrappedEntity, String argumentName)
   at System.Data.Objects.ObjectContext.AddObject(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.AddObject(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 230
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 239
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-10-05 21:26:03,604 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 231
2012-10-05 21:26:03,698 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 231
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 242
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-10-05 21:26:08,581 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 231
2012-10-05 21:26:08,627 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: The EntityKey property can only be set when the current value of the property is null.
   at System.Data.Objects.EntityEntry.GetAndValidateChangeMemberInfo(String entityMemberName, Object complexObject, String complexObjectMemberName, StateManagerTypeMetadata& typeMetadata, String& changingMemberName, Object& changingObject)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName, Object complexObject, String complexObjectMemberName)
   at System.Data.Objects.EntityEntry.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.ObjectStateEntry.System.Data.Objects.DataClasses.IEntityChangeTracker.EntityMemberChanging(String entityMemberName)
   at System.Data.Objects.DataClasses.EntityObject.set_EntityKey(EntityKey value)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 231
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 242
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-10-05 22:04:10,338 [8] ERROR SwizSalesLog - Error while updating order
System.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@OrderId".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Objects.ObjectContext.ExecuteStoreCommand(String commandText, Object[] parameters)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 232
2012-10-05 22:04:10,431 [8] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.Data.SqlClient.SqlException: Must declare the scalar variable "@OrderId".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Objects.ObjectContext.ExecuteStoreCommand(String commandText, Object[] parameters)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 232
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 248
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-10-05 22:05:34,577 [9] ERROR SwizSalesLog - Error while updating order
System.Data.EntityCommandExecutionException: The data reader is incompatible with the specified 'OpenPOSDbModel.OrderDetail'. A member of the type, 'Id', does not have a corresponding column in the data reader with the same name.
   at System.Data.Query.InternalTrees.ColumnMapFactory.GetMemberOrdinalFromReader(DbDataReader storeDataReader, EdmMember member, EdmType currentType, Dictionary`2 renameList)
   at System.Data.Query.InternalTrees.ColumnMapFactory.GetColumnMapsForType(DbDataReader storeDataReader, EdmType edmType, Dictionary`2 renameList)
   at System.Data.Query.InternalTrees.ColumnMapFactory.CreateColumnMapFromReaderAndType(DbDataReader storeDataReader, EdmType edmType, EntitySet entitySet, Dictionary`2 renameList)
   at System.Data.Objects.ObjectContext.InternalTranslate[TElement](DbDataReader reader, String entitySetName, MergeOption mergeOption, Boolean readerOwned)
   at System.Data.Objects.ObjectContext.ExecuteStoreQueryInternal[TElement](String commandText, String entitySetName, MergeOption mergeOption, Object[] parameters)
   at System.Data.Objects.ObjectContext.ExecuteStoreQuery[TElement](String commandText, Object[] parameters)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 232
2012-10-05 22:05:34,655 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.Data.EntityCommandExecutionException: The data reader is incompatible with the specified 'OpenPOSDbModel.OrderDetail'. A member of the type, 'Id', does not have a corresponding column in the data reader with the same name.
   at System.Data.Query.InternalTrees.ColumnMapFactory.GetMemberOrdinalFromReader(DbDataReader storeDataReader, EdmMember member, EdmType currentType, Dictionary`2 renameList)
   at System.Data.Query.InternalTrees.ColumnMapFactory.GetColumnMapsForType(DbDataReader storeDataReader, EdmType edmType, Dictionary`2 renameList)
   at System.Data.Query.InternalTrees.ColumnMapFactory.CreateColumnMapFromReaderAndType(DbDataReader storeDataReader, EdmType edmType, EntitySet entitySet, Dictionary`2 renameList)
   at System.Data.Objects.ObjectContext.InternalTranslate[TElement](DbDataReader reader, String entitySetName, MergeOption mergeOption, Boolean readerOwned)
   at System.Data.Objects.ObjectContext.ExecuteStoreQueryInternal[TElement](String commandText, String entitySetName, MergeOption mergeOption, Object[] parameters)
   at System.Data.Objects.ObjectContext.ExecuteStoreQuery[TElement](String commandText, Object[] parameters)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 232
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 248
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2012-10-05 22:13:04,353 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-05 22:13:57,081 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2005-01-01 19:48:08,897 [9] INFO SwizSalesLog - Payment cancelled! [319989]
2005-01-01 19:48:29,505 [9] INFO SwizSalesLog - Payment cancelled! [319989]
2005-01-01 19:53:48,849 [10] INFO SwizSalesLog - Payment cancelled! [319989]
2005-01-01 19:54:50,657 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 234
2005-01-01 19:54:50,727 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 234
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 248
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2005-01-01 19:55:40,606 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2005-01-01 19:56:23,857 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2005-01-01 19:56:45,456 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 234
2005-01-01 19:56:45,506 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 234
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 248
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 252
2005-01-01 19:56:47,387 [10] INFO SwizSalesLog - Payment cancelled! [319989]
2012-10-27 12:58:48,704 [9] INFO SwizSalesLog - Payment cancelled! [319989]
2012-10-27 12:58:55,744 [9] INFO SwizSalesLog - Payment cancelled! [319989]
2012-10-27 13:09:41,377 [10] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-27 13:22:23,278 [8] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:24:51,010 [10] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 235
2012-10-27 13:24:51,100 [10] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 235
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 255
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 13:24:54,134 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:25:35,759 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:29:46,969 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:30:15,613 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 237
2012-10-27 13:30:15,673 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 237
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 260
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 13:31:49,115 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:32:00,040 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 237
2012-10-27 13:32:00,110 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at System.Data.Objects.ObjectSet`1.Attach(TEntity entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 237
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 260
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 13:32:03,571 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 13:36:12,787 [9] INFO SwizSalesLog - Payment cancelled! [319991]
2012-10-27 13:36:24,813 [9] ERROR SwizSalesLog - Error while fetching order
System.Data.EntityException: The underlying provider failed on Open. ---> System.InvalidOperationException: The current TransactionScope is already complete.
   at System.Transactions.Transaction.get_Current()
   at System.Data.ProviderBase.DbConnectionPool.GetFromTransactedPool(Transaction& transaction)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   --- End of inner exception stack trace ---
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   at System.Data.EntityClient.EntityConnection.Open()
   at System.Data.Objects.ObjectContext.EnsureConnection()
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__2[TResult](IEnumerable`1 sequence)
   at System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle[TResult](IEnumerable`1 query, Expression queryRoot)
   at System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 104
2012-10-27 13:36:25,091 [9] ERROR SwizSalesLog - Error while updating order
System.ArgumentException: Error while fetching order ---> System.Data.EntityException: The underlying provider failed on Open. ---> System.InvalidOperationException: The current TransactionScope is already complete.
   at System.Transactions.Transaction.get_Current()
   at System.Data.ProviderBase.DbConnectionPool.GetFromTransactedPool(Transaction& transaction)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   --- End of inner exception stack trace ---
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   at System.Data.EntityClient.EntityConnection.Open()
   at System.Data.Objects.ObjectContext.EnsureConnection()
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__2[TResult](IEnumerable`1 sequence)
   at System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle[TResult](IEnumerable`1 query, Expression queryRoot)
   at System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 104
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 113
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 255
2012-10-27 13:36:25,476 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.ArgumentException: Error while fetching order ---> System.Data.EntityException: The underlying provider failed on Open. ---> System.InvalidOperationException: The current TransactionScope is already complete.
   at System.Transactions.Transaction.get_Current()
   at System.Data.ProviderBase.DbConnectionPool.GetFromTransactedPool(Transaction& transaction)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   --- End of inner exception stack trace ---
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   at System.Data.EntityClient.EntityConnection.Open()
   at System.Data.Objects.ObjectContext.EnsureConnection()
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__2[TResult](IEnumerable`1 sequence)
   at System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle[TResult](IEnumerable`1 query, Expression queryRoot)
   at System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 104
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 113
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 255
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 261
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 13:36:32,012 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:44:44,512 [10] ERROR SwizSalesLog - Error while fetching order
System.Data.EntityException: The underlying provider failed on Open. ---> System.InvalidOperationException: The current TransactionScope is already complete.
   at System.Transactions.Transaction.get_Current()
   at System.Data.ProviderBase.DbConnectionPool.GetFromTransactedPool(Transaction& transaction)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   --- End of inner exception stack trace ---
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)
   at System.Data.EntityClient.EntityConnection.Open()
   at System.Data.Objects.ObjectContext.EnsureConnection()
   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
   at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
   at System.Data.Objects.ELinq.ObjectQueryProvider.<GetElementFunction>b__2[TResult](IEnumerable`1 sequence)
   at System.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle[TResult](IEnumerable`1 query, Expression queryRoot)
   at System.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 104
2012-10-27 13:45:32,025 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:47:24,714 [9] ERROR SwizSalesLog - Error while fetching order
System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
2012-10-27 13:47:24,794 [9] ERROR SwizSalesLog - Error while updating order
System.ArgumentException: Error while fetching order ---> System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 118
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 261
2012-10-27 13:47:24,834 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.ArgumentException: Error while fetching order ---> System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 118
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 261
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 266
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 13:47:27,717 [9] ERROR SwizSalesLog - Error while fetching order
System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
2012-10-27 13:47:27,767 [9] ERROR SwizSalesLog - Print error
System.ArgumentException: Error while fetching order ---> System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 118
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 91
2012-10-27 13:47:55,050 [10] ERROR SwizSalesLog - Error while fetching order
System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
2012-10-27 13:47:55,110 [10] ERROR SwizSalesLog - Error while creating new order
System.ArgumentException: Error while fetching order ---> System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 118
   at SwizSales.Core.Services.OrderService.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 161
   at SwizSales.ViewModel.SalesViewModel.NewOrder() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 338
2012-10-27 13:48:19,890 [10] ERROR SwizSalesLog - Error while fetching order
System.InvalidOperationException: The object cannot be detached because it is not attached to the ObjectStateManager.
   at System.Data.Objects.ObjectContext.Detach(Object entity, EntitySet expectedEntitySet)
   at System.Data.Objects.ObjectContext.Detach(Object entity)
   at SwizSales.Core.Services.OrderService.GetOrderById(Guid id) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 110
2012-10-27 13:49:51,553 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 13:52:14,396 [10] INFO SwizSalesLog - Payment cancelled! [319992]
2012-10-27 13:52:29,359 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:17:37,410 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:21:31,383 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
2012-10-27 14:21:31,663 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 260
   at SwizSales.ViewModel.SalesViewModel.Save(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 14:21:33,645 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 14:22:08,968 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:25:10,719 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:27:59,838 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:28:17,421 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 14:28:30,204 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
2012-10-27 14:28:30,464 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 261
   at SwizSales.ViewModel.SalesViewModel.Save() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 14:29:09,344 [9] ERROR SwizSalesLog - Error while updating order
System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
2012-10-27 14:29:20,329 [9] ERROR SwizSalesLog - Error while saving order
System.ArgumentException: Error while updating order! ---> System.InvalidOperationException: An object with a temporary EntityKey value cannot be attached to an object context.
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityCollection`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.WalkObjectGraphToIncludeAllRelatedEntities(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 240
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.OrderService.Update(Order entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\OrderService.cs:line 261
   at SwizSales.ViewModel.SalesViewModel.Save() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\SalesViewModel.cs:line 253
2012-10-27 14:30:47,140 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:34:49,501 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:35:17,861 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 14:35:27,112 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:35:32,761 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 14:35:44,488 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 14:35:52,868 [9] ERROR SwizSalesLog - Print error
System.InvalidOperationException: Collection was modified; enumeration operation may not execute.
   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
   at System.Collections.Generic.List`1.Enumerator.MoveNextRare()
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at SwizSales.ViewModel.TicketPrinterViewModel.GetOrder(Guid orderId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 87
2012-10-27 14:40:43,367 [9] INFO SwizSalesLog - Payment cancelled! [319991]
2012-10-27 15:39:43,300 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 177
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 15:39:57,705 [10] ERROR SwizSalesLog - Error while searching orders
System.Data.SqlClient.SqlException (0x80131904): Incorrect syntax near '='.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Objects.ObjectContext.ExecuteStoreCommand(String commandText, Object[] parameters)
   at SwizSales.Core.Services.ReportService.GetCusomerPoints(Guid customerId) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ReportService.cs:line 24
2012-10-27 15:56:47,717 [7] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-27 17:00:54,019 [9] INFO SwizSalesLog - Payment cancelled! [319991]
2012-10-27 18:33:39,795 [10] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-27 18:34:37,410 [8] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-27 18:58:10,065 [9] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-27 18:58:19,938 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument, String printQueueName) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 189
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 19:12:47,890 [10] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument, String printQueueName) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 189
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-27 19:33:01,333 [9] INFO SwizSalesLog - Payment cancelled! [319990]
2012-10-28 10:54:33,598 [9] INFO SwizSalesLog - Payment cancelled! [146082]
2012-10-28 15:15:57,443 [9] ERROR SwizSalesLog - Print error
System.Printing.PrintSystemException: Printing was canceled. Win32 error: The data area passed to a system call is too small.

   at Microsoft.Internal.GDIExporter.CGDIRenderTarget.StartDocumentWithoutCreatingDC(String priterName, String jobName, String filename)
   at Microsoft.Internal.AlphaFlattener.MetroToGdiConverter.StartDocumentWithoutCreatingDC(String jobName)
   at System.Windows.Xps.Serialization.MXDWSerializationManager.EnablePassThru()
   at System.Windows.Xps.XpsDocumentWriter.BeginWrite(Boolean batchMode, Boolean asyncMode, Boolean setPrintTicketHandler, PrintTicket printTicket, PrintTicketLevel printTicketLevel, Boolean printJobIdentifierSet)
   at System.Windows.Xps.XpsDocumentWriter.WriteAsync(FixedDocumentSequence fixedDocumentSequence, PrintTicket printTicket)
   at SwizSales.PrintHelper.PrintXpsToPrinter(XpsDocument xpsDocument, String printQueueName) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Library\PrintHelper.cs:line 189
   at SwizSales.ViewModel.TicketPrinterViewModel.PrintOrder(Order order, Boolean preview) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\TicketPrinterViewModel.cs:line 130
2012-10-28 15:39:25,576 [10] INFO SwizSalesLog - Payment cancelled! [319994]
2012-10-28 08:50:35,661 [8] ERROR SwizSalesLog - Error while updating Purchase
System.InvalidOperationException: A referential integrity constraint violation occurred: The property values that define the referential constraints are not consistent between principal and dependent objects in the relationship.
   at System.Data.Objects.DataClasses.RelationshipManager.CheckReferentialConstraintProperties(EntityEntry ownerEntry)
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.StockService.Update(Purchase entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\StockService.cs:line 191
2012-10-28 08:50:35,721 [8] ERROR SwizSalesLog - Error while saving purchase
System.ArgumentException: Error while updating Purchase ---> System.InvalidOperationException: A referential integrity constraint violation occurred: The property values that define the referential constraints are not consistent between principal and dependent objects in the relationship.
   at System.Data.Objects.DataClasses.RelationshipManager.CheckReferentialConstraintProperties(EntityEntry ownerEntry)
   at System.Data.Objects.ObjectContext.AttachSingleObject(IEntityWrapper wrappedEntity, EntitySet entitySet, String argumentName)
   at System.Data.Objects.DataClasses.RelatedEnd.AddEntityToObjectStateManager(IEntityWrapper wrappedEntity, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.AddGraphToObjectStateManager(IEntityWrapper wrappedEntity, Boolean relationshipAlreadyExists, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelatedEnd.IncludeEntity(IEntityWrapper wrappedEntity, Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.EntityReference`1.Include(Boolean addRelationshipAsUnchanged, Boolean doAttach)
   at System.Data.Objects.DataClasses.RelationshipManager.AddRelatedEntitiesToObjectStateManager(Boolean doAttach)
   at System.Data.Objects.ObjectContext.AttachTo(String entitySetName, Object entity)
   at SwizSales.Core.Services.StockService.Update(Purchase entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\StockService.cs:line 191
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.StockService.Update(Purchase entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\StockService.cs:line 213
   at SwizSales.ViewModel.ManagePurchaseViewModel.Save() in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\ManagePurchaseViewModel.cs:line 201
2012-11-01 12:50:55,965 [9] WARN SwizSalesLog - Saved successfully!
2012-11-01 12:56:10,772 [10] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 145
2012-11-01 12:57:23,457 [10] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:01:24,908 [8] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 145
2012-11-01 13:05:07,782 [10] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 145
2012-11-01 13:07:01,146 [10] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 145
2012-11-01 13:07:26,278 [10] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:10:49,292 [9] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 146
2012-11-01 13:10:51,172 [9] ERROR SwizSalesLog - Error while updating product with barcode 741
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 151
   at SwizSales.ViewModel.ManagePurchaseViewModel.UpdateProduct(PurchaseDetail item) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\ManagePurchaseViewModel.cs:line 214
2012-11-01 13:10:51,402 [9] WARN SwizSalesLog - Error while updating product with barcode 741
2012-11-01 13:11:11,649 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:11:26,000 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:15:46,045 [9] ERROR SwizSalesLog - Error while updating product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 146
2012-11-01 13:15:48,595 [9] ERROR SwizSalesLog - Error while updating product with barcode 12
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at SwizSales.Core.Services.ProductService.Update(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 151
   at SwizSales.ViewModel.ManagePurchaseViewModel.UpdateProduct(PurchaseDetail item) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\ManagePurchaseViewModel.cs:line 228
2012-11-01 13:15:48,805 [9] WARN SwizSalesLog - Error while updating product with barcode 12
2012-11-01 13:16:01,457 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:16:09,157 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-01 13:18:29,862 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:07:22,623 [9] ERROR SwizSalesLog - Error while adding product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Add(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 115
2012-11-04 11:07:22,896 [9] ERROR SwizSalesLog - Error while updating product with barcode 55
System.ArgumentException: Error while adding new product!
   at SwizSales.Core.Services.ProductService.Add(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 121
   at SwizSales.ViewModel.ManagePurchaseViewModel.UpdateProduct(PurchaseDetail item) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales\ViewModel\ManagePurchaseViewModel.cs:line 229
2012-11-04 11:07:23,077 [9] WARN SwizSalesLog - Error while updating product with barcode 55
2012-11-04 11:10:06,099 [9] ERROR SwizSalesLog - Error while adding product
System.Data.UpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductCategory". The conflict occurred in database "OpenPOSDb", table "dbo.Categories", column 'Id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Mapping.Update.Internal.DynamicUpdateCommand.Execute(UpdateTranslator translator, EntityConnection connection, Dictionary`2 identifierValues, List`1 generatedValues)
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   --- End of inner exception stack trace ---
   at System.Data.Mapping.Update.Internal.UpdateTranslator.Update(IEntityStateManager stateManager, IEntityAdapter adapter)
   at System.Data.EntityClient.EntityAdapter.Update(IEntityStateManager entityCache)
   at System.Data.Objects.ObjectContext.SaveChanges(SaveOptions options)
   at System.Data.Objects.ObjectContext.SaveChanges()
   at SwizSales.Core.Services.ProductService.Add(Product entity) in C:\Users\cackharot\documents\visual studio 2010\Projects\SwizSales\SwizSales.Core\Services\ProductService.cs:line 115
2012-11-04 11:15:40,570 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:26:43,567 [9] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:30:48,203 [10] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:39:57,570 [10] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:40:36,201 [10] WARN SwizSalesLog - Purchase #4564 Saved successfully!
2012-11-04 11:41:16,478 [10] INFO SwizSalesLog - Payment cancelled! [319994]
2012-11-04 11:41:48,161 [10] INFO SwizSalesLog - Payment cancelled! [319994]
2012-11-04 12:34:55,203 [9] INFO SwizSalesLog - Payment cancelled! [319993]
